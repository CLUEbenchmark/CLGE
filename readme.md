# CLGE
Chinese Language Generation Evaluation 中文生成任务基准测评

为中文生成任务提供预训练模型和任务的排行榜。

## 一键运行

```
1、克隆项目 
   git clone --depth=1 https://github.com/CLUEbenchmark/CLGE.git
2、进入到相应任务的目录
   例如运行 csl 任务
       cd CLGE/tasks/csl  
3、运行对应任务的脚本: 会自动安装依赖、下载模型和数据集并开始运行。
       sh run_bert_base.sh
   如运行 sh run_bert_base.sh 会开始 csl 任务在 BERT_base 上的训练
```

## 评价指标

**1. Rouge-L**

Rouge-L 根据生成文本和参考文本的最长公共子序列（LCS）得出测评分数。
python rouge 只适用于英文，使用 BERT Tokenizer 将中文转换为数字 id 再计算得分。


## 数据集介绍

### **1. CSL 中长文本摘要生成**

取自[中文科学文献数据(CSL)](https://github.com/P01son6415/chinese-scientific-literature-dataset)，选取 10k 条计算机相关领域论文及其标题作为训练集。

```
数据量：训练集(10,000)，验证集(1,000)，测试集(1,000)
示例：
{
    title: 基于活跃时间分组的软件众包工人选择机制
    content: 针对现有的软件众包工人选择机制对工人间协同开发考虑不足的问题,在竞标模式的基础上提出一种基于活跃时间分组的软件众包工人选择机制。首先,基于活跃时间将众包工人划分为多个协同开发组;然后,根据组内工人开发能力和协同因子计算协同工作组权重;最后,选定权重最大的协同工作组为最优工作组,并根据模块复杂度为每个任务模块从该组内选择最适合的工人。实验结果表明,该机制相比能力优先选择方法在工人平均能力上仅有0. 57%的差距,同时因为保证了工人间的协同而使项目风险平均降低了32%,能有效指导需多人协同进行的众包软件任务的工人选择。
}
```

[运行结果](docs/csl.md)

|         模型          | 验证集（val) |               训练参数              |
| :-------------------: | :----------: |  :--------------------------------: |
|      ALBERT-tiny      |    54.45     |  batch_size=8, length=256, epoch=5, lr=1e-5  |
|       BERT-base       |    66.69     | batch_size=8, length=256, epoch=5, lr=1e-5  |
|     BERT-wwm-ext      |    66.78     |  batch_size=8, length=256, epoch=10, lr=1e-5 |
|    RoBERTa-wwm-ext    |    66.91     |  batch_size=8, length=256, epoch=10, lr=1e-5 |
|   RoBERTa-wwm-large   |    68.10     |  batch_size=4, length=256, epoch=10, lr=1e-5 |
|     LSTM-Seq2Seq      |    43.77     |  batch_size=64, length=256, epoch=10, lr=1e-5 |

### **2. LCSTS 短文本摘要生成**

微博短文本及其作者给出的摘要，选取了数据集中 PART_II 部分作为训练集。

```
数据量：训练集(8,666)，验证集(1,000)，测试集(1,000)
示例：
{
    abstract: 新《环保法》元旦起实施企业违法可拘留责任人
    content: 正式实施的新《环保法》对企业惩治力度大大加强，受到罚款处罚，被责令改正，拒不改正的，依法作出处罚决定的行政机关可以自责令更改之日的次日起，按照原处罚数额按日连续处罚。企业违法可拘留责任人。
}
```

[运行结果](docs/lcsts.md)

|         模型          | 验证集（val) |               训练参数              |
| :-------------------: | :----------: |  :--------------------------------: |
|      ALBERT-tiny      |    31.49     |  batch_size=16, length=128, epoch=10, lr=1e-5  |
|       BERT-base       |    35.59     |  batch_size=16, length=128, epoch=5, lr=1e-5  |
|     BERT-wwm-ext      |    35.33     |  batch_size=16, length=128, epoch=5, lr=1e-5 |
|    RoBERTa-wwm-ext    |    36.11     |  batch_size=16, length=128, epoch=5, lr=1e-5 |
|   RoBERTa-wwm-large   |    35.05     |  batch_size=8, length=128, epoch=8, lr=1e-5  |
|     LSTM-Seq2Seq      |    12.66     |  batch_size=64, length=128, epoch=5, lr=1e-5 |


### **3. WebQA 阅读理解问答**

百度 WebQA 问答数据集，取自科学空间的精简版本，只保留了阅读材料、问题和答案。

```
数据量：训练集(10,000)，验证集(1,000)，测试集(1,000)
示例：
{
    'question': '《齐民要术》的作者贾思勰是那个时代的人？',
    {
        'answer': '', 
        'passage': '在古代农学发展史上，贾思勰所著《齐民要术》是古代农学体系形成的标志。'
    },
    {
        'answer': '北魏',
        'passage': '答：1、中国古代农业百科全书《齐民要术》是北魏时期的中国杰出农学家贾思勰所著的一部综合性农书，也是世界农学史上最早的专著之一。'
     },
}
```

|         模型          | 验证集（val) |               训练参数              |
| :-------------------: | :----------: |  :--------------------------------: |
|      ALBERT-tiny      |    70.08     |  batch_size=8, epoch=5, lr=1e-5  |
|       BERT-base       |    80.85     |  batch_size=4, epoch=5, lr=1e-5  |
|     BERT-wwm-ext      |    83.36     |  batch_size=4, epoch=5, lr=1e-5 |
|    RoBERTa-wwm-ext    |    85.85     |  batch_size=4, epoch=5, lr=1e-5 |
|   RoBERTa-wwm-large   |    -     |  - |

### 4.THUCNEWS 中长文本标题生成

清华NLP组提供的THUCNews新闻文本数据集，根据新闻内容生成标题。训练采用了自回归模型**seq2seq**，其中encoder部分采用了BiLSTM，decoder采用LSTM。后续会尝试不同的编码、解码组件，并提供测试结果和得分。

为了加速收敛，解码时采取了Attention和先验知识2种策略，具体可以参考[2]。

```
数据量：64k 篇文章（标题 + 正文）
惨烈3加时背后还有欣喜 6分钟完美防守如何延续？
新浪体育讯北京时间1月14日消息，火箭在主场击败森林狼，实在不是什么让人意外的结果。而如果你看了今天火箭和森林狼比赛的过程，那么，对于这场三个加时的比赛的惊心动魄紧张之余，恐怕也会感叹火箭队的实力不济。在阿隆-布鲁克斯，特雷沃-阿里扎和肖恩-巴蒂尔都发挥算是正常的情况下，火箭今天打的如此尴尬，主要原因就是内线的羸弱。看看今天火箭的内线球员，除了查克-海耶斯之外，其他人的发挥都有着或多或少的问题。路易斯-斯科拉的篮板球糟糕，卡尔-兰德里依然没有走出低迷，而大卫-安德森则成为了对手主要攻击的防守漏洞。好吧，火箭好歹也赢了比赛，这些总结缺点的任务还是交给火箭的教练班子来完成，还是让我们来看看比赛中一些让人欣喜的镜头吧。先来看看火箭第一节的防守盛宴。从第一节比赛还剩下8分39秒的时候，一直到第一节比赛还剩下2分30秒的时候，在长达6分钟的时间里，火箭依靠自己的防守，让森林狼没有得分。当然，我们不否认，这种防守盛宴需要对手的配合，如果森林狼的状态能够稍微好点，也不至于在这么长的时间内一分不得。但是火箭在第一节比赛中，不管是激情，积极程度还是手感，确实都远远的超越了对手森林狼。让对手在6分钟的时间内不得分，也算得上是火箭在本赛季的一项壮举。可惜，6分钟的防守并没有能够延续，否则，这比赛恐怕早就已经尘埃落定了。然后就是大卫-安德森出人意料的表演。在第三节比赛还剩下几秒钟的时候，火箭队发动最后一次进攻。安德森在罚球线稍微远点的地方拿球之后，在正面防守他的是森林狼的头号球星艾尔-杰弗森。安德森身体虽然不如对手强壮，但是脚步和灵活性方面还是相当不错。安德森直接一个假动作之后，就直接冲着内线突破。杰弗森被假动作骗的缓了一下，想要转身跟上安德森防守的时候，脚下已经转不过来，直接一屁股坐在了地上。要知道，杰弗森也是联盟中一流的内线球员，他在今天和安德森的对位中也算是占尽优势。但是，安德森能够晃倒杰弗森，好歹也算是在场上好好的出了一口气。当然，我们更希望看到的是，安德森在场上的表现能够压制杰弗森。
```

部分测试结果：

```
迭代约100个epoch，训练时长约2.5小时
s1：近日，网上流出夏雨和袁泉吃饭视频，两人都穿着低调白衣。在聚餐时夏雨站起来表演魔术，袁泉则是一脸开心大笑，非常捧丈夫的场。整个画面十分温馨有爱。
predict：袁泉夏雨演绎魔术 画面十分温馨有爱
s2：王先生在海底捞就餐过程中，在锅底吃出烟头，与商家沟通过程中，店员觉得顾客音量大，对店面影响不好，报警让警方过来处理。目前双方仍在协商中。
predict：王先生在海底捞就餐过程中出烟头
s3：1月5日，作为全球新年后的第一场国际田联金标赛事，2020年厦门马拉松鸣枪开跑，在3万跑者前进的步伐中迎来18岁“成人礼”。
predict：2020年厦门马拉松鸣枪开跑 18岁成人礼
```

## Reference

[1] bert4keras：https://github.com/bojone/bert4keras

[2]玩转Keras之seq2seq自动生成标题：[https://kexue.fm/archives/5861#seq2seq%E6%8F%90%E5%8D%87](https://kexue.fm/archives/5861#seq2seq提升)

